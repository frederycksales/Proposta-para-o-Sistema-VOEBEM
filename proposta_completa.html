<!DOCTYPE html>
<html>

<head>
    <title>proposta_completa.md</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    
<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

html,footer,header{
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Custom MD PDF CSS
 */
html,footer,header{
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";

 }
body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>
<link rel="stylesheet" href="file:///r%3A/2.Travail/1.Enseignement/Cours/_1.Outils/2.Developpement/1.SCSS/main.css" type="text/css"><link rel="stylesheet" href="file:///d%3A/rdaros/Cours/_1.Outils/2.Developpement/1.SCSS/main.css" type="text/css">
</head>

<body>
    <p>PONTIFÍCIA UNIVERSIDADE CATÓLICA DE MINAS GERAIS<br>
PUC Minas Virtual</p>
<p>ATIVIDADE DE NIVELAMENTO<br>
Proposta de Solução para o Sistema VOEBEM</p>
<p>Frederyck Baleeiro Espinheiro Sales<br>
Castanhal - PA</p>
<p>Belo Horizonte<br>
Abril de 2025.<br>
NIVELAMENTO SRE</p>
<p>Sumário</p>
<p>NIVELAMENTO SRE</p>
<ol>
<li>Arquitetura do Sistema - Diagrama C4</li>
<li>Estratégia de Deploy e Resiliência</li>
<li>Plano de Melhoria da Confiabilidade e Percepção do Cliente</li>
</ol>
<p></p>
<h1 id="1-arquitetura-do-sistema---diagrama-c4">1. Arquitetura do Sistema - Diagrama C4</h1>
<p>Para ilustrar claramente a arquitetura proposta para o Sistema VOEBEM, utilizamos a metodologia C4 Model. Esta abordagem fornece diferentes níveis de detalhe, desde uma visão geral do contexto até a estrutura interna dos componentes principais, facilitando a compreensão por diferentes públicos (técnicos e de negócio).</p>
<ul>
<li>
<p><strong>Nível 1 (Contexto):</strong><br>
<em>Este diagrama mostra o Sistema de Reservas VOEBEM em seu contexto, identificando os principais usuários e as integrações com sistemas externos essenciais para sua operação.</em></p>
<p><img src="assets/c4-n1-contexto.svg" alt="Diagrama de Contexto C4 - Sistema VOEBEM"></p>
<ul>
<li>
<p><strong>Usuários (Personas):</strong></p>
<ul>
<li><strong>Passageiro/Cliente:</strong> Pessoa que busca, reserva e gerencia voos através dos canais digitais (Website/App Mobile).</li>
<li><strong>Agente de Reservas (Funcionário VOEBEM):</strong> Funcionário que utiliza o sistema internamente para criar, modificar e gerenciar reservas em nome dos clientes.</li>
<li><strong>Administrador do Sistema (Funcionário VOEBEM):</strong> Funcionário responsável pela configuração de voos, tarifas, regras de negócio e gerenciamento geral do sistema.</li>
</ul>
</li>
<li>
<p><strong>Sistema Principal:</strong></p>
<ul>
<li><strong>Sistema de Reservas VOEBEM (Software System):</strong> A aplicação central que gerencia todo o inventário de voos, trechos, assentos, processa reservas e fornece informações aos usuários e sistemas externos.</li>
</ul>
</li>
<li>
<p><strong>Sistemas Externos:</strong></p>
<ul>
<li><strong>Sistema de Pagamentos (External System):</strong> Serviço externo responsável pelo processamento seguro de transações financeiras para a emissão de bilhetes. <em>Interage com o Sistema VOEBEM para autorizar e confirmar pagamentos.</em></li>
<li><strong>Sistema de Check-in (External System):</strong> Sistema utilizado nos aeroportos (ou online) para validar reservas, confirmar a presença do passageiro e atribuir/confirmar assentos antes do embarque. <em>Interage com o Sistema VOEBEM para consultar dados da reserva/assento e atualizar o status de check-in.</em></li>
<li><strong>Sistemas GDS (Global Distribution Systems) (External System):</strong> Plataformas globais (Exemplo: Amadeus, Sabre) que distribuem o inventário de voos da VOEBEM para agências de viagens e outros canais. <em>Interage com o Sistema VOEBEM para consultar disponibilidade, criar reservas (originadas externamente) e sincronizar informações.</em></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Nível 2 (Container):</strong><br>
<em>Este diagrama detalha os principais blocos de construção (containers) do Sistema de Reservas VOEBEM, suas responsabilidades, tecnologias e como eles interagem, utilizando um banco de dados centralizado conforme requisito.</em></p>
<p><img src="assets/c4-n2-container.svg" alt="Diagrama de Containers C4 - Sistema VOEBEM"></p>
<p><strong>Containers Principais:</strong></p>
<ul>
<li>
<p><strong>Web App (SPA) (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Interface web principal acessada via navegador.</li>
<li><strong>Tecnologia:</strong> React.</li>
<li><strong>Responsabilidade:</strong> Fornecer a interface do usuário para Passageiros, Agentes de Reservas e Administradores realizarem suas tarefas (consultas, reservas, gerenciamento).</li>
<li><strong>Interage com:</strong> API Gateway (via HTTPS/JSON).</li>
</ul>
</li>
<li>
<p><strong>Mobile App (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Aplicativo móvel nativo ou híbrido.</li>
<li><strong>Tecnologia:</strong> React Native / Nativo (iOS/Android).</li>
<li><strong>Responsabilidade:</strong> Fornecer uma interface otimizada para Passageiros em dispositivos móveis.</li>
<li><strong>Interage com:</strong> API Gateway (via HTTPS/JSON).</li>
</ul>
</li>
<li>
<p><strong>API Gateway (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Ponto único de entrada para todas as requisições externas das interfaces (SPA, Mobile App) e de sistemas externos (Check-in).</li>
<li><strong>Tecnologia:</strong> Exemplo: AWS API Gateway, Nginx, Kong.</li>
<li><strong>Responsabilidade:</strong> Roteamento de requisições para os serviços backend apropriados, autenticação/autorização inicial, aplicação de rate limiting, agregação leve de respostas (opcional).</li>
<li><strong>Interage com:</strong> Web App, Mobile App, Sistema de Check-in, API de Reservas, API de Voos.</li>
</ul>
</li>
<li>
<p><strong>API de Reservas (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Microsserviço backend focado no domínio de reservas.</li>
<li><strong>Tecnologia:</strong> Java / Spring Boot.</li>
<li><strong>Responsabilidade:</strong> Gerenciar todo o ciclo de vida das reservas (criação, consulta, cancelamento, prorrogação), dados de passageiros, orquestrar interações com pagamento, GDS e check-in, gerenciar reserva de assentos.</li>
<li><strong>Interage com:</strong> API Gateway, Banco de Dados Central, API de Voos, Cache, Sistema de Mensageria, Sistema de Pagamentos, Sistemas GDS.</li>
</ul>
</li>
<li>
<p><strong>API de Voos (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Microsserviço backend focado no domínio de inventário de voos.</li>
<li><strong>Tecnologia:</strong> Python / Django.</li>
<li><strong>Responsabilidade:</strong> Gerenciar informações sobre voos, trechos, horários, aeroportos, aeronaves e calcular/consultar disponibilidade de voos e assentos.</li>
<li><strong>Interage com:</strong> API Gateway, Banco de Dados Central, Cache, API de Reservas.</li>
</ul>
</li>
<li>
<p><strong>Serviço de Notificação (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Serviço assíncrono para envio de notificações.</li>
<li><strong>Tecnologia:</strong> Node.js.</li>
<li><strong>Responsabilidade:</strong> Consumir eventos do Sistema de Mensageria (Exemplo: <code>ReservaConfirmada</code>, <code>PrazoExpirando</code>) e enviar notificações aos usuários via canais apropriados (Email, SMS - integração com serviços externos específicos não mostrada neste nível).</li>
<li><strong>Interage com:</strong> Sistema de Mensageria.</li>
</ul>
</li>
</ul>
<p><strong>Containers de Dados e Mensageria:</strong></p>
<ul>
<li>
<p><strong>Banco de Dados Central (Database Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Banco de dados relacional centralizado que armazena todos os dados da aplicação.</li>
<li><strong>Tecnologia:</strong> PostgreSQL.</li>
<li><strong>Responsabilidade:</strong> Armazenar de forma persistente e transacional os dados de reservas, passageiros, voos, trechos, aeroportos, aeronaves, assentos, etc.</li>
<li><strong>Acessado por:</strong> API de Reservas, API de Voos.</li>
</ul>
</li>
<li>
<p><strong>Cache (Database Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Armazenamento de dados em memória para acesso rápido.</li>
<li><strong>Tecnologia:</strong> Redis.</li>
<li><strong>Responsabilidade:</strong> Acelerar consultas frequentes (Exemplo: disponibilidade de voos/assentos), armazenar dados de sessão (opcional), gerenciar locks temporários (Exemplo: durante seleção de assento).</li>
<li><strong>Acessado por:</strong> API de Reservas, API de Voos.</li>
</ul>
</li>
<li>
<p><strong>Sistema de Mensageria (Container):</strong></p>
<ul>
<li><strong>Descrição:</strong> Broker de mensagens para comunicação assíncrona.</li>
<li><strong>Tecnologia:</strong> RabbitMQ.</li>
<li><strong>Responsabilidade:</strong> Desacoplar a comunicação entre serviços, permitindo que eventos sejam publicados (pela API de Reservas) e consumidos (pelo Serviço de Notificação) de forma independente e resiliente.</li>
<li><strong>Acessado por:</strong> API de Reservas, Serviço de Notificação.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Nível 3 (Componentes - Exemplo para API de Reservas):</strong><br>
<em>Este diagrama detalha a estrutura interna do container &quot;API de Reservas&quot;, mostrando seus principais componentes lógicos e como eles colaboram para realizar as funcionalidades de reserva e interagir com dependências externas.</em></p>
<p><img src="assets/c4-n3-component-api-reservas.svg" alt="Diagrama de Componentes C4 - API de Reservas"></p>
<p><strong>Componentes Principais da API de Reservas:</strong></p>
<ul>
<li>
<p><strong>Controllers (<code>ReservationController</code>, <code>PassengerController</code>, <code>CheckinDataController</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Spring MVC RestController.</li>
<li><strong>Responsabilidade:</strong> Receber requisições HTTP da API Gateway, validar entradas básicas e delegar para os serviços apropriados. O <code>CheckinDataController</code> expõe endpoints específicos para consulta pelo Sistema de Check-in.</li>
</ul>
</li>
<li>
<p><strong>Services (<code>ReservationService</code>, <code>SeatManagementService</code>, <code>PaymentIntegrationService</code>, <code>GdsIntegrationService</code>, <code>CheckinDataService</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Spring Service.</li>
<li><strong>Responsabilidade:</strong> Contêm a lógica de negócio principal.
<ul>
<li><code>ReservationService</code>: Orquestra o fluxo de criação, consulta, atualização de reservas, validações de regras de negócio.</li>
<li><code>SeatManagementService</code>: Gerencia a lógica de seleção, bloqueio temporário (usando cache) e confirmação de assentos.</li>
<li><code>PaymentIntegrationService</code>: Coordena a comunicação com o <code>PaymentGatewayClient</code> para processar pagamentos.</li>
<li><code>GdsIntegrationService</code>: Lida com a lógica de receber/enviar dados de/para os <code>Sistemas GDS</code> através do <code>GdsApiClient</code>.</li>
<li><code>CheckinDataService</code>: Fornece dados consolidados e validados sobre a reserva e assento para o <code>CheckinDataController</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Repositories (<code>ReservationRepository</code>, <code>PassengerRepository</code>, <code>ReservedSeatRepository</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Spring Data JPA Repository.</li>
<li><strong>Responsabilidade:</strong> Abstrair o acesso (leitura/escrita) aos dados das entidades correspondentes no <code>Banco de Dados Central</code>.</li>
</ul>
</li>
<li>
<p><strong>Clients (<code>FlightApiClient</code>, <code>PaymentGatewayClient</code>, <code>GdsApiClient</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Feign Client / RestTemplate / SDKs específicos.</li>
<li><strong>Responsabilidade:</strong> Encapsular a comunicação via rede com outros containers ou sistemas externos.
<ul>
<li><code>FlightApiClient</code>: Comunica-se com a <code>API de Voos</code> para obter informações de voos, trechos e validar disponibilidade/assentos.</li>
<li><code>PaymentGatewayClient</code>: Interage com o <code>Sistema de Pagamentos</code> externo.</li>
<li><code>GdsApiClient</code>: Interage com os <code>Sistemas GDS</code> externos.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Messaging (<code>ReservationEventPublisher</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Spring AMQP Template.</li>
<li><strong>Responsabilidade:</strong> Publicar eventos de domínio significativos (Exemplo: <code>ReservaConfirmada</code>, <code>PagamentoFalhou</code>) no <code>Sistema de Mensageria</code> para processamento assíncrono (Exemplo: notificações).</li>
</ul>
</li>
<li>
<p><strong>Caching (<code>SeatAvailabilityCache</code>):</strong></p>
<ul>
<li><strong>Tecnologia:</strong> Spring Data Redis.</li>
<li><strong>Responsabilidade:</strong> Interagir com o <code>Cache (Redis)</code> para operações específicas, como gerenciamento de locks distribuídos durante a seleção de assentos para evitar concorrência.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Destaques Obrigatórios:</strong></p>
<ul>
<li><strong>Escalabilidade:</strong>
<ul>
<li><strong>Horizontal:</strong> Utilização de múltiplos containers/instâncias para os serviços (Frontend, API Gateway, Serviços Backend) gerenciados por orquestradores (Kubernetes, AWS ECS) ou grupos de autoescalonamento (Auto Scaling Groups). O Banco de Dados pode escalar leituras com réplicas.</li>
<li><strong>Vertical:</strong> Aumento de recursos (CPU/Memória) das instâncias/containers conforme necessário (menos preferível para serviços stateless).</li>
</ul>
</li>
<li><strong>Balanceamento de Carga:</strong> Uso de Load Balancers (Exemplo: AWS ELB, Nginx) na frente da API Gateway e dos serviços backend para distribuir o tráfego entre as instâncias disponíveis.</li>
<li><strong>Alta Disponibilidade:</strong>
<ul>
<li>Deploy das instâncias/containers em múltiplas Zonas de Disponibilidade (AZs) na nuvem.</li>
<li>Uso de bancos de dados gerenciados com replicação multi-AZ e failover automático.</li>
<li>Implementação de Health Checks para que o Load Balancer e o orquestrador removam instâncias não saudáveis.</li>
</ul>
</li>
</ul>
<h1 id="2-estrat%C3%A9gia-de-deploy-e-resili%C3%AAncia">2. Estratégia de Deploy e Resiliência</h1>
<p>Esta seção detalha as estratégias propostas para garantir entregas de software frequentes, confiáveis e com baixo risco para o Sistema VOEBEM, abordando o pipeline de CI/CD, a metodologia de deploy em produção e o plano de rollback.</p>
<h2 id="21-pipeline-de-cicd-integra%C3%A7%C3%A3o-cont%C3%ADnua--entrega-cont%C3%ADnua">2.1 Pipeline de CI/CD (Integração Contínua / Entrega Contínua)</h2>
<p>Propõe-se um pipeline de CI/CD robusto para automatizar o processo de build, teste e deploy dos diferentes containers (microsserviços, frontend) do sistema, conforme ilustrado abaixo.</p>
<ul>
<li>
<p><strong>Ferramentas Propostas:</strong></p>
<ul>
<li><strong>Controle de Versão:</strong> Git (com repositórios hospedados no GitLab ou GitHub).</li>
<li><strong>Servidor de CI/CD:</strong> GitLab CI/CD ou GitHub Actions (integrados à plataforma de repositórios).</li>
<li><strong>Containerização:</strong> Docker (para empacotar as aplicações e suas dependências).</li>
<li><strong>Registro de Container:</strong> Docker Hub, GitLab Container Registry, AWS ECR ou similar.</li>
<li><strong>Orquestração de Containers:</strong> Kubernetes (gerenciado na nuvem, Exemplo: AWS EKS, Google GKE, Azure AKS).</li>
<li><strong>Ferramentas de Teste:</strong> JUnit (para Java/API Reservas), PyTest (para Python/API Voos), Jest/Cypress (para Frontend React).</li>
<li><strong>Análise de Código (Opcional):</strong> SonarQube (para análise estática de segurança e qualidade).</li>
</ul>
</li>
<li>
<p><strong>Fluxo do Pipeline:</strong> O diagrama abaixo ilustra as etapas sequenciais e pontos de decisão do pipeline, desde o commit do código até o deploy em produção, incluindo validações intermediárias.</p>
<p><img src="assets/diagrama-cicd.svg" alt="Diagrama do Pipeline de CI/CD"></p>
</li>
<li>
<p><strong>Etapas Detalhadas:</strong></p>
<ol>
<li><strong>Commit &amp; Trigger:</strong> Desenvolvedor envia código, iniciando o pipeline.</li>
<li><strong>Build &amp; Unit Test:</strong> Compilação e testes unitários. Falhas interrompem o pipeline.</li>
<li><strong>Code Scan (Opcional):</strong> Análise estática de código.</li>
<li><strong>Build da Imagem Docker:</strong> Criação da imagem da aplicação.</li>
<li><strong>Push para Registro:</strong> Envio da imagem para o registro.</li>
<li><strong>Deploy em Staging:</strong> Implantação em ambiente de homologação.</li>
<li><strong>Testes de Integração/Aceitação:</strong> Validação funcional e de integração em Staging. Falhas interrompem o pipeline.</li>
<li><strong>Aprovação (Manual/Automática):</strong> Ponto de controle antes da produção.</li>
<li><strong>Deploy em Produção:</strong> Implantação em produção usando a estratégia Blue/Green.</li>
<li><strong>Monitoramento Pós-Deploy:</strong> Observação ativa da nova versão em produção.</li>
</ol>
</li>
</ul>
<h2 id="22-estrat%C3%A9gia-de-deploy">2.2 Estratégia de Deploy</h2>
<p>Considerando a criticidade do sistema e a necessidade de minimizar riscos e downtime, a estratégia de deploy recomendada é <strong>Blue/Green Deployment</strong>, cujo fluxo é apresentado no diagrama a seguir.</p>
<ul>
<li>
<p><strong>Justificativa:</strong></p>
<ul>
<li><strong>Zero Downtime:</strong> Transição suave de tráfego.</li>
<li><strong>Testes em Produção Isolados:</strong> Validação da nova versão sem impacto no usuário.</li>
<li><strong>Rollback Instantâneo:</strong> Reversão rápida em caso de problemas.</li>
<li><strong>Simplicidade Conceitual:</strong> Fluxo claro para deploy e rollback.</li>
</ul>
</li>
<li>
<p><strong>Funcionamento (Ilustrado no Diagrama):</strong></p>
<p><img src="assets/diagrama-bluegreen.svg" alt="Diagrama da Estratégia Blue/Green"></p>
<ol>
<li><strong>Ambiente Blue Ativo:</strong> Versão atual (v1) recebe o tráfego.</li>
<li><strong>Provisionamento Green:</strong> Nova versão (v2) é implantada em um ambiente idêntico (Green).</li>
<li><strong>Testes no Green:</strong> Validação da v2 no ambiente Green isolado.</li>
<li><strong>Switch de Tráfego:</strong> Se os testes passarem, o tráfego é direcionado para o ambiente Green (v2).</li>
<li><strong>Monitoramento do Green:</strong> A v2 é monitorada em produção.</li>
<li><strong>Estabilização ou Rollback:</strong> Se a v2 estiver estável, o ambiente Blue (v1) é desativado. Se problemas críticos forem detectados, o tráfego é revertido imediatamente para o Blue (v1) (Rollback).</li>
<li><strong>Desativação do Blue:</strong> Após confirmação da estabilidade do Green, o ambiente Blue é liberado.</li>
</ol>
</li>
<li>
<p><strong>Benefícios para VOEBEM:</strong> Essa abordagem minimiza o risco de impacto ao usuário durante atualizações e permite reversões imediatas caso surjam problemas inesperados, garantindo assim a continuidade das operações críticas de reserva e a confiança do cliente.</p>
</li>
</ul>
<h2 id="23-estrat%C3%A9gia-de-rollback">2.3 Estratégia de Rollback</h2>
<p>A estratégia de rollback é uma parte intrínseca do fluxo Blue/Green, como visualizado no diagrama anterior.</p>
<ul>
<li>
<p><strong>Processo de Rollback (Detalhado):</strong></p>
<ol>
<li><strong>Detecção de Problema:</strong> Identificação de falha crítica na versão Green (v2) ativa, via monitoramento ou alertas.</li>
<li><strong>Acionamento:</strong> Manual pela equipe SRE/Operações ou automático por violação de SLOs.</li>
<li><strong>Redirecionamento de Tráfego:</strong> Reconfiguração do Load Balancer/Roteador para enviar 100% do tráfego de volta ao ambiente Blue (v1), que contém a versão estável anterior. Esta é a ação principal e imediata do rollback.</li>
<li><strong>Análise de Causa Raiz:</strong> Investigação do problema no ambiente Green (v2), agora isolado.</li>
<li><strong>Correção e Novo Deploy:</strong> Após correção, o ciclo de deploy pode ser reiniciado.</li>
</ol>
</li>
<li>
<p><strong>Garantias:</strong></p>
<ul>
<li><strong>Velocidade:</strong> MTTR minimizado pela rapidez do redirecionamento.</li>
<li><strong>Segurança:</strong> Versão estável anterior sempre disponível.</li>
<li><strong>Consistência:</strong> Processo claro e passível de automação.</li>
</ul>
</li>
</ul>
<h1 id="3-plano-de-melhoria-da-confiabilidade-e-percep%C3%A7%C3%A3o-do-cliente">3. Plano de Melhoria da Confiabilidade e Percepção do Cliente</h1>
<p>A confiabilidade e a percepção positiva do cliente são cruciais para o sucesso do VOEBEM. Este plano descreve as práticas de Engenharia de Confiabilidade de Sites (SRE - Site Reliability Engineering) que propomos para alcançar e manter altos níveis de serviço, alinhando a operação técnica com a experiência do cliente.</p>
<h2 id="31-monitoramento-e-observabilidade">3.1 Monitoramento e Observabilidade</h2>
<p>Uma estratégia robusta de monitoramento e observabilidade é fundamental para entender o comportamento do sistema, detectar problemas proativamente e garantir que as metas de negócio sejam atendidas. Propõe-se uma abordagem baseada nos três pilares da observabilidade: métricas, logs e traces.</p>
<ul>
<li>
<p><strong>SLIs (Service Level Indicators) Chave:</strong> Indicadores quantitativos que medem aspectos específicos do serviço. Exemplos para VOEBEM:</p>
<table>
<thead>
<tr>
<th>Categoria</th>
<th>SLI (Indicador)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Disponibilidade</td>
<td>% de requisições bem-sucedidas (HTTP 2xx/3xx) na API Gateway (endpoints chave)</td>
</tr>
<tr>
<td>Disponibilidade</td>
<td>% de requisições bem-sucedidas nas APIs (Reservas, Voos)</td>
</tr>
<tr>
<td>Latência</td>
<td>Tempo de resposta (p95, p99) para busca de voos na API Gateway</td>
</tr>
<tr>
<td>Latência</td>
<td>Tempo de resposta (p95) para criação de reserva na API de Reservas</td>
</tr>
<tr>
<td>Taxa de Erros</td>
<td>% de requisições com erro (HTTP 5xx) nas APIs (Gateway, Reservas, Voos)</td>
</tr>
<tr>
<td>Taxa de Erros</td>
<td>Taxa de falhas na integração com Sistema de Pagamentos</td>
</tr>
<tr>
<td>Taxa de Erros</td>
<td>Taxa de erros na publicação/consumo de mensagens (Sistema de Mensageria)</td>
</tr>
<tr>
<td>Saturação</td>
<td>Uso de CPU/Memória dos containers</td>
</tr>
<tr>
<td>Saturação</td>
<td>Uso de conexões do banco de dados</td>
</tr>
<tr>
<td>Saturação</td>
<td>Profundidade da fila no Sistema de Mensageria</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>SLOs (Service Level Objectives):</strong> Metas claras e mensuráveis para os SLIs mais críticos, definindo o nível de serviço esperado. Exemplos:</p>
<table>
<thead>
<tr>
<th>SLI Referente</th>
<th>Exemplo de SLO (Meta)</th>
<th>Janela</th>
</tr>
</thead>
<tbody>
<tr>
<td>Disponibilidade API Gateway (Busca/Reserva)</td>
<td>&gt;= 99.9% de requisições bem-sucedidas</td>
<td>Mensal</td>
</tr>
<tr>
<td>Latência Busca de Voos (p95)</td>
<td>&lt; 800ms</td>
<td>Contínua</td>
</tr>
<tr>
<td>Latência Criação de Reserva (p95)</td>
<td>&lt; 1500ms</td>
<td>Contínua</td>
</tr>
<tr>
<td>Taxa de Erros API Reservas (5xx)</td>
<td>&lt; 0.1%</td>
<td>Mensal</td>
</tr>
</tbody>
</table>
<p><em>(Nota: Estes são exemplos iniciais e devem ser refinados com base em dados históricos e necessidades de negócio).</em></p>
</li>
<li>
<p><strong>Ferramentas Propostas:</strong></p>
<table>
<thead>
<tr>
<th>Pilar</th>
<th>Ferramenta(s) Proposta(s)</th>
<th>Principal Responsabilidade</th>
</tr>
</thead>
<tbody>
<tr>
<td>Métricas</td>
<td>Prometheus + Grafana</td>
<td>Coleta e Visualização de Métricas (SLIs, SLOs, Saúde)</td>
</tr>
<tr>
<td>Logs</td>
<td>Fluentd/Bit + Loki + Grafana (ou ELK Stack)</td>
<td>Coleta, Agregação e Consulta de Logs</td>
</tr>
<tr>
<td>Tracing</td>
<td>Jaeger + OpenTelemetry + Grafana</td>
<td>Coleta e Visualização de Traces Distribuídos</td>
</tr>
<tr>
<td>Alertas</td>
<td>Alertmanager + PagerDuty/Opsgenie</td>
<td>Definição de Regras de Alerta e Notificação On-Call</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Alertas:</strong></p>
<ul>
<li>Configurados no <strong>Alertmanager</strong> (parte do ecossistema Prometheus).</li>
<li>Baseados principalmente na <strong>violação dos SLOs</strong> (Exemplo: taxa de erro acima do limite por X minutos, latência p99 excedendo o objetivo) ou em <strong>sintomas críticos</strong> (Exemplo: serviço indisponível, erro de acesso ao banco de dados, fila de mensagens crescendo rapidamente, certificados expirando).</li>
<li>Alertas devem ser <strong>acionáveis</strong>, indicando claramente o problema e o impacto potencial.</li>
<li>Direcionamento para a equipe de plantão (on-call) através de ferramentas como <strong>PagerDuty</strong> ou <strong>Opsgenie</strong>, com diferentes níveis de severidade e canais de notificação (Exemplo: chat, telefone).</li>
</ul>
</li>
</ul>
<h2 id="32-automa%C3%A7%C3%A3o-de-recupera%C3%A7%C3%A3o">3.2 Automação de Recuperação</h2>
<p>Para aumentar a resiliência e reduzir a necessidade de intervenção manual em caso de falhas, propõe-se a implementação de mecanismos de recuperação automática, principalmente aproveitando recursos do Kubernetes e serviços gerenciados na nuvem.</p>
<ul>
<li>
<p><strong>Auto-Healing (Kubernetes):</strong></p>
<ul>
<li><strong>Liveness Probes:</strong> Verificações periódicas configuradas nos Deployments/StatefulSets. Se um container falhar na verificação (Exemplo: travado, não respondendo a um endpoint <code>/healthz</code>), o Kubelet o reiniciará automaticamente na mesma instância (Node).</li>
<li><strong>Readiness Probes:</strong> Verificações que indicam se um container está pronto para receber tráfego (Exemplo: aplicação iniciada, conexões estabelecidas). O Kubernetes só enviará tráfego (via Services) para Pods que estejam &quot;Ready&quot;. Se um Pod falhar na Readiness Probe, ele é temporariamente removido do balanceamento de carga até se recuperar.</li>
<li><strong>ReplicaSets/Deployments:</strong> Garantem que o número desejado de réplicas de um serviço esteja sempre em execução. Se um Node falhar, os Pods que estavam nele são automaticamente reagendados em outros Nodes saudáveis.</li>
</ul>
</li>
<li>
<p><strong>Auto-Scaling (Kubernetes):</strong></p>
<ul>
<li><strong>Horizontal Pod Autoscaler (HPA):</strong> Ajusta automaticamente o número de réplicas de um Deployment/StatefulSet com base em métricas observadas, como utilização média de CPU, memória ou métricas customizadas (Exemplo: requisições por segundo, profundidade de fila via KEDA). Isso garante que o sistema tenha capacidade suficiente para lidar com picos de carga e reduza custos em períodos de baixa utilização.</li>
<li><strong>Cluster Autoscaler (Provedor de Nuvem):</strong> Adiciona ou remove automaticamente Nós (VMs) ao cluster Kubernetes com base na demanda por recursos (Pods pendentes por falta de CPU/memória).</li>
</ul>
</li>
<li>
<p><strong>Failover Automático (Componentes Stateful):</strong></p>
<ul>
<li><strong>Banco de Dados Central (PostgreSQL):</strong> Utilizar um serviço de banco de dados gerenciado na nuvem (Exemplo: AWS RDS, Google Cloud SQL, Azure Database for PostgreSQL) configurado em modo <strong>Multi-AZ (Multi-Availability Zone)</strong>. O provedor de nuvem gerencia a replicação síncrona para uma instância standby em outra AZ e realiza o failover automático para a standby em caso de falha da instância primária, com mínima interrupção.</li>
<li><strong>Cache (Redis):</strong> Utilizar um serviço gerenciado (Exemplo: AWS ElastiCache for Redis, Google Memorystore) com replicação e failover automático habilitados, se disponível e necessário para a criticidade dos dados em cache.</li>
</ul>
</li>
<li>
<p><strong>Chaos Engineering (Prática Recomendada):</strong></p>
<ul>
<li>Após estabilizar o sistema e implementar as automações, introduzir falhas controladas periodicamente em ambientes de pré-produção (ou até mesmo produção, com cuidado) para validar a eficácia dos mecanismos de auto-healing, auto-scaling e failover.</li>
<li><strong>Ferramentas:</strong> Chaos Mesh (CNCF), LitmusChaos (CNCF), ou ferramentas específicas do provedor de nuvem.</li>
<li><strong>Objetivo:</strong> Descobrir fraquezas ocultas na resiliência do sistema antes que elas causem incidentes reais.</li>
</ul>
</li>
</ul>
<h2 id="33-gest%C3%A3o-de-incidentes">3.3 Gestão de Incidentes</h2>
<p>Mesmo com automação, incidentes ocorrerão. Um processo claro e eficiente de gestão de incidentes é crucial para minimizar o impacto nos usuários e aprender com as falhas.</p>
<p><strong>Técnicas Chave para Redução de MTTD e MTTR:</strong></p>
<table>
<thead>
<tr>
<th>Foco</th>
<th>Técnica</th>
<th>Descrição/Objetivo</th>
</tr>
</thead>
<tbody>
<tr>
<td>MTTD</td>
<td>Alertas Acionáveis</td>
<td>Garantir que alertas sejam claros, relevantes e indiquem o impacto/causa.</td>
</tr>
<tr>
<td>MTTD</td>
<td>Dashboards Consolidados</td>
<td>Visualizar rapidamente a saúde dos serviços, SLOs e métricas chave.</td>
</tr>
<tr>
<td>MTTD</td>
<td>Correlação (Métricas/Logs/Traces)</td>
<td>Usar ferramentas de observabilidade para conectar diferentes sinais rapidamente.</td>
</tr>
<tr>
<td>MTTR</td>
<td>Runbooks/Playbooks</td>
<td>Documentar procedimentos passo-a-passo para diagnóstico e mitigação.</td>
</tr>
<tr>
<td>MTTR</td>
<td>Escalas de Plantão (On-Call)</td>
<td>Definir responsabilidades claras e ferramentas de notificação eficientes.</td>
</tr>
<tr>
<td>MTTR</td>
<td>Ferramentas de Comunicação</td>
<td>Usar canais dedicados (chat) para comunicação focada durante o incidente.</td>
</tr>
<tr>
<td>MTTR</td>
<td>Automação de Mitigação</td>
<td>Automatizar ações de recuperação para incidentes bem compreendidos (opcional).</td>
</tr>
<tr>
<td>MTTR</td>
<td>Acesso e Permissões</td>
<td>Garantir que a equipe on-call tenha o acesso necessário e seguro.</td>
</tr>
<tr>
<td>Ambos</td>
<td>Post-mortems &quot;Blameless&quot;</td>
<td>Analisar a causa raiz sistêmica e definir ações de melhoria para prevenir recorrência.</td>
</tr>
</tbody>
</table>
<p><strong>Ciclo de Vida Básico de um Incidente (Diagrama):</strong></p>
<p><img src="assets/diagrama-ciclo-incidente.svg" alt="Ciclo de Vida Básico de um Incidente"></p>
<ul>
<li>
<p><strong>Redução de MTTD (Mean Time To Detect):</strong></p>
<ul>
<li><strong>Alertas Acionáveis:</strong> Garantir que os alertas configurados (baseados em SLOs e sintomas) sejam claros, relevantes e direcionem para a possível causa ou impacto. Evitar ruído excessivo de alertas não acionáveis.</li>
<li><strong>Dashboards Consolidados (Grafana):</strong> Manter dashboards que mostrem rapidamente a saúde dos serviços principais, o status dos SLOs e métricas chave, facilitando a identificação visual de anomalias.</li>
<li><strong>Correlação:</strong> Utilizar as ferramentas de observabilidade (Grafana com Loki/Jaeger/Prometheus) para correlacionar rapidamente métricas, logs e traces durante a investigação inicial.</li>
</ul>
</li>
<li>
<p><strong>Redução de MTTR (Mean Time To Recover):</strong></p>
<ul>
<li><strong>Runbooks/Playbooks:</strong> Documentar procedimentos passo-a-passo para diagnosticar e mitigar incidentes comuns ou alertas específicos. Devem ser mantidos atualizados e facilmente acessíveis.</li>
<li><strong>Escalas de Plantão (On-Call):</strong> Definir escalas de plantão claras, com responsabilidades bem definidas e ferramentas adequadas (PagerDuty/Opsgenie) para notificação e escalonamento.</li>
<li><strong>Ferramentas de Comunicação:</strong> Utilizar canais dedicados em ferramentas de chat (Slack, Teams) para comunicação focada durante um incidente (&quot;War Room&quot; virtual).</li>
<li><strong>Automação de Mitigação (Opcional):</strong> Para incidentes muito bem compreendidos, automatizar ações de mitigação (Exemplo: reiniciar um serviço específico, escalar temporariamente um recurso) via scripts ou ferramentas de automação.</li>
<li><strong>Acesso e Permissões:</strong> Garantir que a equipe on-call tenha o acesso necessário e seguro para investigar e aplicar correções nos ambientes.</li>
<li><strong>Cultura de Post-mortems &quot;Blameless&quot;:</strong>
<ul>
<li>Realizar análises pós-incidente detalhadas para cada incidente significativo.</li>
<li>Foco em entender a <strong>causa raiz sistêmica</strong> (tecnologia, processo, monitoramento) e não em culpar indivíduos.</li>
<li>Documentar o incidente, a linha do tempo, o impacto, as ações tomadas e, principalmente, as <strong>ações de acompanhamento</strong> (melhorias no código, infraestrutura, monitoramento, runbooks) para prevenir recorrências.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="34-feedback-dos-clientes">3.4 Feedback dos Clientes</h2>
<p>A percepção do cliente é a medida final da confiabilidade. Coletar e agir sobre o feedback do cliente é essencial para complementar os dados técnicos de monitoramento.</p>
<ul>
<li>
<p><strong>Canais de Coleta:</strong></p>
<table>
<thead>
<tr>
<th>Canal</th>
<th>Descrição / Exemplo</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pesquisas In-App/Web</td>
<td>Perguntas curtas sobre a experiência após ações chave (reserva, busca).</td>
</tr>
<tr>
<td>Formulários de Contato/Suporte</td>
<td>Canal direto para reportar problemas ou dificuldades específicas.</td>
</tr>
<tr>
<td>Análise de Chamados de Suporte</td>
<td>Categorizar e analisar os motivos dos contatos com a equipe de suporte.</td>
</tr>
<tr>
<td>Monitoramento de Redes Sociais/Avaliação</td>
<td>Acompanhar menções à VOEBEM em plataformas públicas (Twitter, Reclame Aqui).</td>
</tr>
<tr>
<td>Pesquisas de Satisfação (NPS/CSAT)</td>
<td>Medir a satisfação geral e a probabilidade de recomendação periodicamente.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Processamento e Ação:</strong></p>
<p><strong>Fluxo Básico de Tratamento de Feedback (Diagrama):</strong></p>
<p><img src="assets/diagrama-fluxo-feedback.svg" alt="Fluxo Básico de Tratamento de Feedback"></p>
<ul>
<li><strong>Centralização:</strong> Agregar o feedback de diferentes canais em uma ferramenta ou processo unificado (Exemplo: um quadro Kanban, uma ferramenta de gestão de feedback).</li>
<li><strong>Análise e Categorização:</strong> Identificar temas recorrentes, problemas específicos, sugestões de melhoria. Correlacionar reclamações (Exemplo: lentidão) com dados de monitoramento técnico.</li>
<li><strong>Priorização:</strong> Avaliar o impacto e a frequência dos problemas reportados pelos clientes.</li>
<li><strong>Integração com Backlog:</strong> Transformar feedback acionável em itens de trabalho (bugs, melhorias) para as equipes de desenvolvimento e SRE.</li>
<li><strong>Refinamento de SLIs/SLOs:</strong> Usar o feedback para validar se os SLIs/SLOs atuais refletem a experiência real do usuário ou se novos indicadores são necessários (Exemplo: sucesso na conclusão do fluxo de reserva ponta-a-ponta).</li>
<li><strong>Comunicação (Fechamento do Loop):</strong> Informar aos clientes (quando apropriado e possível) sobre as ações tomadas com base em seus feedbacks, demonstrando que a empresa ouve e age.</li>
</ul>
</li>
</ul>
<h1 id="esquema-entidade-relacionamento-er---sistema-voebem">Esquema Entidade-Relacionamento (ER) - Sistema VOEBEM</h1>
<p>Este documento descreve a estrutura do banco de dados relacional proposto para o sistema VOEBEM, mostrando as entidades principais, seus atributos e os relacionamentos entre elas.</p>
<h2 id="diagrama-er">Diagrama ER</h2>
<p><img src="assets/er-diagram-voebem.svg" alt="Diagrama ER - VOEBEM"></p>
<p><em>(Nota: O diagrama SVG acima representa visualmente o esquema definido abaixo.)</em></p>
<h2 id="descri%C3%A7%C3%A3o-das-entidades-e-relacionamentos">Descrição das Entidades e Relacionamentos</h2>
<h3 id="entidades">Entidades</h3>
<h4 id="passageiro">PASSAGEIRO</h4>
<p>Representa uma pessoa que faz uma reserva.</p>
<ul>
<li><code>id_passageiro</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>nome</code> (VARCHAR): Nome do passageiro, não nulo.</li>
</ul>
<h4 id="reserva">RESERVA</h4>
<p>Representa uma reserva feita por um passageiro para um ou mais trechos de voo.</p>
<ul>
<li><code>id_reserva</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>codigo_reserva</code> (VARCHAR): Código único da reserva, não nulo.</li>
<li><code>data_criacao</code> (DATETIME): Data e hora de criação da reserva, não nulo (padrão: data/hora atual).</li>
<li><code>data_emissao</code> (DATETIME): Data e hora de emissão (confirmação) da reserva, pode ser nulo.</li>
<li><code>prazo_validade</code> (DATETIME): Prazo limite para confirmação da reserva, não nulo.</li>
<li><code>status</code> (VARCHAR): Status atual da reserva (Ex: Pendente, Confirmada, Cancelada, Emitida), não nulo.</li>
<li><code>prorrogada</code> (BOOLEAN): Indica se o prazo de validade foi prorrogado, não nulo (padrão: false).</li>
<li><code>passageiro_id</code> (INTEGER): Chave estrangeira referenciando o passageiro que fez a reserva, não nulo.</li>
<li><code>fonte_reserva</code> (VARCHAR): Origem da reserva (Ex: Interno, Web, GDS_Amadeus), pode ser nulo.</li>
<li><code>id_externo_reserva</code> (VARCHAR): ID da reserva no sistema externo (Ex: GDS PNR), pode ser nulo.</li>
<li><code>id_transacao_pagamento</code> (VARCHAR): ID da transação no sistema de pagamento, pode ser nulo.</li>
<li><code>status_pagamento</code> (VARCHAR): Status do pagamento (Ex: Pendente, Aprovado, Falhou), pode ser nulo.</li>
<li><code>valor_pago</code> (DECIMAL): Valor efetivamente pago pela reserva, pode ser nulo.</li>
</ul>
<h4 id="voo">VOO</h4>
<p>Representa um voo como uma sequência de trechos, com origem e destino finais.</p>
<ul>
<li><code>id_voo</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>codigo_voo</code> (VARCHAR): Código único do voo, não nulo.</li>
<li><code>aeroporto_origem_final</code> (INTEGER): Chave estrangeira referenciando o aeroporto de origem final do voo, não nulo.</li>
<li><code>aeroporto_destino_final</code> (INTEGER): Chave estrangeira referenciando o aeroporto de destino final do voo, não nulo.</li>
</ul>
<h4 id="trecho">TRECHO</h4>
<p>Representa um segmento individual de um voo, conectando dois aeroportos com uma aeronave específica.</p>
<ul>
<li><code>id_trecho</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>voo_id</code> (INTEGER): Chave estrangeira referenciando o voo ao qual este trecho pertence, não nulo.</li>
<li><code>ordem_trecho</code> (INTEGER): Ordem do trecho dentro do voo, não nulo (compõe chave única com <code>voo_id</code>).</li>
<li><code>aeroporto_origem_id</code> (INTEGER): Chave estrangeira referenciando o aeroporto de origem deste trecho, não nulo.</li>
<li><code>aeroporto_destino_id</code> (INTEGER): Chave estrangeira referenciando o aeroporto de destino deste trecho, não nulo.</li>
<li><code>aeronave_id</code> (INTEGER): Chave estrangeira referenciando a aeronave usada neste trecho, não nulo.</li>
</ul>
<h4 id="voodiasemana">VOO_DIA_SEMANA</h4>
<p>Indica em quais dias da semana um voo específico opera e seus horários.</p>
<ul>
<li><code>voo_id</code> (INTEGER): Chave primária composta, chave estrangeira referenciando o voo.</li>
<li><code>dia_semana</code> (INTEGER): Chave primária composta, dia da semana (0=Domingo, 6=Sábado).</li>
<li><code>hora_partida</code> (TIME): Hora de partida neste dia da semana, não nulo.</li>
<li><code>hora_chegada</code> (TIME): Hora de chegada neste dia da semana, não nulo.</li>
</ul>
<h4 id="cidade">CIDADE</h4>
<p>Representa uma cidade.</p>
<ul>
<li><code>id_cidade</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>codigo_cidade</code> (VARCHAR): Código único da cidade (Ex: SAO), não nulo.</li>
<li><code>nome</code> (VARCHAR): Nome da cidade, não nulo.</li>
</ul>
<h4 id="aeroporto">AEROPORTO</h4>
<p>Representa um aeroporto.</p>
<ul>
<li><code>id_aeroporto</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>codigo_iata</code> (VARCHAR): Código IATA único do aeroporto (Ex: GRU), não nulo.</li>
<li><code>nome</code> (VARCHAR): Nome do aeroporto, não nulo.</li>
<li><code>cidade_id</code> (INTEGER): Chave estrangeira referenciando a cidade onde o aeroporto está localizado, não nulo.</li>
</ul>
<h4 id="aeronave">AERONAVE</h4>
<p>Representa uma aeronave.</p>
<ul>
<li><code>id_aeronave</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>modelo</code> (VARCHAR): Modelo da aeronave, não nulo.</li>
<li><code>fabricante</code> (VARCHAR): Fabricante da aeronave.</li>
<li><code>capacidade_total</code> (INTEGER): Capacidade total de passageiros da aeronave, não nulo.</li>
</ul>
<h4 id="assento">ASSENTO</h4>
<p>Representa um assento individual em uma aeronave.</p>
<ul>
<li><code>id_assento</code> (INTEGER): Chave primária, auto-incremento.</li>
<li><code>aeronave_id</code> (INTEGER): Chave estrangeira referenciando a aeronave à qual o assento pertence, não nulo.</li>
<li><code>numero_assento</code> (VARCHAR): Número/identificação do assento (compõe chave única com <code>aeronave_id</code>), não nulo.</li>
<li><code>classe</code> (VARCHAR): Classe do assento (Ex: Econômica, Executiva), não nulo.</li>
</ul>
<h4 id="reservatrecho">RESERVA_TRECHO</h4>
<p>Tabela associativa que liga uma RESERVA a um TRECHO específico que faz parte dessa reserva.</p>
<ul>
<li><code>reserva_id</code> (INTEGER): Parte da chave primária composta, chave estrangeira referenciando a RESERVA.</li>
<li><code>trecho_id</code> (INTEGER): Parte da chave primária composta, chave estrangeira referenciando o TRECHO.</li>
<li><code>data_hora_partida</code> (DATETIME): Data e hora de partida programada para este trecho na reserva, não nulo.</li>
<li><code>data_hora_chegada</code> (DATETIME): Data e hora de chegada programada para este trecho na reserva, não nulo.</li>
<li><code>classe_reservada</code> (VARCHAR): Classe em que o assento foi reservado para este trecho, não nulo.</li>
</ul>
<h4 id="reservaassento">RESERVA_ASSENTO</h4>
<p>Tabela associativa que liga um <code>RESERVA_TRECHO</code> a um <code>ASSENTO</code> específico reservado para uma data de voo particular.</p>
<ul>
<li><code>reserva_id</code> (INTEGER): Parte da chave primária composta, chave estrangeira referenciando <code>RESERVA_TRECHO</code>.</li>
<li><code>trecho_id</code> (INTEGER): Parte da chave primária composta, chave estrangeira referenciando <code>RESERVA_TRECHO</code>.</li>
<li><code>assento_id</code> (INTEGER): Parte da chave primária composta, chave estrangeira referenciando o ASSENTO, não nulo.</li>
<li><code>data_voo</code> (DATE): Data específica em que este trecho do voo está sendo reservado para este assento (compõe chave única com <code>assento_id</code> e <code>trecho_id</code>), não nulo.</li>
<li><code>status_checkin</code> (VARCHAR): Status do check-in para este assento/trecho (Ex: Pendente, Realizado), pode ser nulo.</li>
</ul>
<h3 id="relacionamentos">Relacionamentos</h3>
<ul>
<li><code>PASSAGEIRO</code> <strong>faz</strong> uma ou mais (<code>o{</code>) <code>RESERVA</code>s.</li>
<li><code>RESERVA</code> <strong>contem_trecho</strong> um ou mais (<code>o{</code>) <code>RESERVA_TRECHO</code>s.</li>
<li><code>TRECHO</code> <strong>eh_reservado_em</strong> zero ou mais (<code>o{</code>) <code>RESERVA_TRECHO</code>s.</li>
<li><code>VOO</code> <strong>composto_por</strong> um ou mais (<code>o{</code>) <code>TRECHO</code>s.</li>
<li><code>AEROPORTO</code> pode ser a <strong>origem_de</strong> zero ou mais (<code>o{</code>) <code>TRECHO</code>s.</li>
<li><code>AEROPORTO</code> pode ser o <strong>destino_de</strong> zero ou mais (<code>o{</code>) <code>TRECHO</code>s.</li>
<li><code>AERONAVE</code> é <strong>usado_em</strong> zero ou mais (<code>o{</code>) <code>TRECHO</code>s.</li>
<li><code>VOO</code> <strong>opera_em</strong> um ou mais (<code>o{</code>) <code>VOO_DIA_SEMANA</code>s.</li>
<li><code>CIDADE</code> é <strong>localizado_em</strong> zero ou mais (<code>o{</code>) <code>AEROPORTO</code>s.</li>
<li><code>AERONAVE</code> <strong>possui</strong> um ou mais (<code>o{</code>) <code>ASSENTO</code>s.</li>
<li><code>AEROPORTO</code> pode ser a <strong>origem_final_em</strong> zero ou mais (<code>o{</code>) <code>VOO</code>s.</li>
<li><code>AEROPORTO</code> pode ser o <strong>destino_final_em</strong> zero ou mais (<code>o{</code>) <code>VOO</code>s.</li>
<li><code>RESERVA_TRECHO</code> tem um <strong>assento_reservado_para</strong> zero ou mais (<code>o{</code>) <code>RESERVA_ASSENTO</code>s.</li>
<li><code>ASSENTO</code> é <strong>reservado_em</strong> zero ou mais (<code>o{</code>) <code>RESERVA_ASSENTO</code>s.</li>
</ul>
<h2 id="esquema-dbml">Esquema DBML</h2>
<p>Abaixo está o esquema do banco de dados definido usando a sintaxe DBML (Database Markup Language).</p>
<pre class="hljs"><code><div>Table PASSAGEIRO {
  id_passageiro integer [pk, increment]
  nome varchar(255) [not null]
}

Table RESERVA {
  id_reserva integer [pk, increment]
  codigo_reserva varchar(50) [unique, not null]
  data_criacao datetime [default: `now()`, not null]
  data_emissao datetime [null]
  prazo_validade datetime [not null]
  status varchar(50) [not null, note: 'Pendente, Confirmada, Cancelada, Expirada']
  prorrogada boolean [default: false, not null]
  passageiro_id integer [not null]

  Indexes {
    (codigo_reserva)
  }
}

Table VOO {
  id_voo integer [pk, increment]
  codigo_voo varchar(10) [unique, not null]
  aeroporto_origem_final integer [not null]
  aeroporto_destino_final integer [not null]
  Indexes {
    (codigo_voo)
  }
}

Table TRECHO {
  id_trecho integer [pk, increment]
  voo_id integer [not null]
  ordem_trecho integer [not null, note: 'Sequência do trecho dentro do voo (1, 2, ...)']
  aeroporto_origem_id integer [not null]
  aeroporto_destino_id integer [not null]
  aeronave_id integer [not null, note: 'Aeronave planejada para este trecho']

  Indexes {
    (voo_id, ordem_trecho) [unique]
  }
}

Table VOO_DIA_SEMANA {
  voo_id integer [pk]
  dia_semana integer [pk, note: '0=Domingo, 1=Segunda,..., 6=Sábado']
  hora_partida time [not null]
  hora_chegada time [not null]
}

Table CIDADE {
  id_cidade integer [pk, increment]
  codigo_cidade varchar(3) [unique, not null, note: 'Ex: SAO, RIO']
  nome varchar(100) [not null]

  Indexes {
    (codigo_cidade)
  }
}

Table AEROPORTO {
  id_aeroporto integer [pk, increment]
  codigo_iata varchar(3) [unique, not null, note: 'Ex: GRU, GIG, POA']
  nome varchar(150) [not null]
  cidade_id integer [not null]

  Indexes {
    (codigo_iata)
  }
}

Table AERONAVE {
  id_aeronave integer [pk, increment]
  modelo varchar(100) [not null]
  fabricante varchar(100)
  capacidade_total integer [not null]
}

Table ASSENTO {
  id_assento integer [pk, increment]
  aeronave_id integer [not null]
  numero_assento varchar(5) [not null, note: 'Ex: 1A, 20F']
  classe varchar(50) [not null, note: 'Econômica, Executiva, Primeira Classe']

  Indexes {
    (aeronave_id, numero_assento) [unique]
  }
}

Table RESERVA_TRECHO {
  reserva_id integer [pk]
  trecho_id integer [pk]
  data_hora_partida datetime [not null, note: 'Data e hora exatas da partida deste trecho para esta reserva']
  data_hora_chegada datetime [not null, note: 'Data e hora exatas da chegada deste trecho para esta reserva']
  classe_reservada varchar(50) [not null, note: 'Classe específica reservada para este trecho (pode ser diferente da classe do assento)']
}

Table RESERVA_ASSENTO {
  reserva_id integer [pk]
  trecho_id integer [pk]
  assento_id integer [pk, not null]
  data_voo date [not null, note: 'Data específica do voo para esta reserva de assento']

  Indexes {
    (assento_id, trecho_id, data_voo) [unique]
  }
}

Ref: RESERVA.passageiro_id &gt; PASSAGEIRO.id_passageiro
Ref: RESERVA_TRECHO.reserva_id &gt; RESERVA.id_reserva
Ref: RESERVA_TRECHO.trecho_id &gt; TRECHO.id_trecho
Ref: TRECHO.voo_id &gt; VOO.id_voo
Ref: TRECHO.aeroporto_origem_id &gt; AEROPORTO.id_aeroporto
Ref: TRECHO.aeroporto_destino_id &gt; AEROPORTO.id_aeroporto
Ref: TRECHO.aeronave_id &gt; AERONAVE.id_aeronave
Ref: VOO_DIA_SEMANA.voo_id &gt; VOO.id_voo
Ref: AEROPORTO.cidade_id &gt; CIDADE.id_cidade
Ref: ASSENTO.aeronave_id &gt; AERONAVE.id_aeronave
Ref: VOO.aeroporto_origem_final &gt; AEROPORTO.id_aeroporto
Ref: VOO.aeroporto_destino_final &gt; AEROPORTO.id_aeroporto
Ref: RESERVA_ASSENTO.(reserva_id, trecho_id) &gt; RESERVA_TRECHO.(reserva_id, trecho_id)
Ref: RESERVA_ASSENTO.assento_id &gt; ASSENTO.id_assento
</div></code></pre>

</body>

</html>